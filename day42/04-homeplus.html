<!DOCTYPE html>
<html lang="ko">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>04-homeplus.html</title>
        <style>
            .filter {
                width: 800px;
                margin: 20px auto;
                text-align: center;
            }
            table {
                border: 2px solid black;
                border-collapse: collapse;
                margin: auto;
            }

            th {
                background-color: #eee;
            }

            td,
            th {
                border: 1px solid black;
                padding: 10px;
            }

            .딸기 {
                background-color: red;
                color: white;
            }

            .블루베리 {
                background-color: blueviolet;
                color: white;
            }

            .체리 {
                background-color: hotpink;
                color: white;
            }

            .기타 {
                background-color: green;
                color: white;
            }
        </style>
    </head>
    <body>
        <h1>04-homeplus.html</h1>
        <hr />

        <div class="filter">
            <label for=""><input type="checkbox" id="strawberry" />딸기</label>
            <label for=""
                ><input type="checkbox" id="blueberry" />블루베리</label
            >
            <label for=""><input type="checkbox" id="cherry" />체리</label>
            <label for=""><input type="checkbox" id="etc" />기타</label>
        </div>

        <table>
            <thead>
                <tr>
                    <th class="name">상품이름</th>
                    <th class="category">카테고리</th>
                    <th class="price">가격</th>
                    <th class="grade">평점</th>
                    <th class="salesCount">판매수</th>
                    <th class="reviewCount">리뷰 횟수</th>
                </tr>
            </thead>
            <tbody></tbody>
        </table>
        <script src="./homeplus(berry).js"></script>
        <script>
            const dataList = arr.map((ob) => {
                // JSON.stringify(ob) : ob객체를 JSON형식 문자열로 변환한다.
                // JSON.parse(str) : str을 JSON형식 기준으로 객체로 변환한다.
                const ob2 = JSON.parse(JSON.stringify(ob));
                if (ob2.name.includes("블루베리")) ob2.category = "블루베리";
                else if (ob2.name.includes("딸기")) ob2.category = "딸기";
                else if (ob2.name.includes("체리")) ob2.category = "체리";
                else ob2.category = "기타";
                return ob2;
            });

            function loadHandler() {
                const tbody = document.querySelector("tbody");
                let tag = "";
                dataList.forEach((ob) => {
                    tag += `<tr class="${ob.category}">`;
                    tag += `<td>${ob.name}</td>`;
                    tag += `<td>${ob.category}</td>`;
                    tag += `<td>${ob.price}</td>`;
                    tag += `<td>${ob.grade}</td>`;
                    tag += `<td>${ob.salesCount}</td>`;
                    tag += `<td>${ob.reviewCount}</td>`;
                    tag += `</td>`;
                });
                tbody.innerHTML += tag;
            }

            const checkboxList = document.querySelectorAll(
                'input[type="checkbox"]'
            );

            function checkboxHandler(event) {
                const arr = Array.from(checkboxList);
                console.log(arr);

                const flag = arr.map((box) => box.checked);
                console.log(flag);
                const result = dataList.filter((ob) => {
                    const flag1 = ob.category.includes("딸기");
                    const flag2 = ob.category.includes("블루베리");
                    const flag3 = ob.category.includes("체리");
                    const flag4 = ob.category.includes("기타");

                    let f = true;

                    if (flag[0]) f = flag1;
                    if (flag[1]) f = flag2;
                    if (flag[2]) f = flag3;
                    if (flag[3]) f = flag4;

                    if (flag[0] && flag[1]) f = flag1 || flag2;
                    if (flag[0] && flag[2]) f = flag1 || flag3;
                    if (flag[0] && flag[3]) f = flag1 || flag4;
                    if (flag[1] && flag[2]) f = flag2 || flag3;
                    if (flag[1] && flag[3]) f = flag2 || flag4;
                    if (flag[2] && flag[3]) f = flag3 || flag4;

                    if (flag[0] && flag[1] && flag[2])
                        f = flag1 || flag2 || flag3;
                    if (flag[1] && flag[2] && flag[3])
                        f = flag2 || flag3 || flag4;
                    if (flag[2] && flag[3] && flag[0])
                        f = flag3 || flag4 || flag1;
                    if (flag[1] && flag[3] && flag[0])
                        f = flag2 || flag4 || flag1;

                    if (flag[0] && flag[1] && flag[2] && flag[3]) f = true;

                    return f;
                });
                document.querySelector("tbody").innerHTML = "";
                let tag = ``;
                result.forEach((ob) => {
                    tag += `<tr class="${ob.category}">`;
                    tag += `<td>${ob.name}</td>`;
                    tag += `<td>${ob.category}</td>`;
                    tag += `<td>${ob.price}</td>`;
                    tag += `<td>${ob.grade}</td>`;
                    tag += `<td>${ob.salesCount}</td>`;
                    tag += `<td>${ob.reviewCount}</td>`;
                    tag += `</tr>`;
                });
                document.querySelector("tbody").innerHTML += tag;
            }
            checkboxList.forEach((box) => (box.onclick = checkboxHandler));

            window.onload = loadHandler;

            // // 강사님 코드
            // const boxArray = Array.from(
            //     document.querySelectorAll('input[type="checkbox"]')
            // );
            // function filterHandler(event) {
            //     const checkedBoxes = boxArray
            //         .filter((box) => box.checked)
            //         .map((box) => box.id);
            //     console.log(checkedBoxes);

            //     document.querySelectorAll("tbody > tr").forEach((tr) => {
            //         const flag = checkedBoxes.includes(tr.classList[0]);
            //         if (checkedBoxes.length == 0) tr.classList.remove("hidden");
            //         else if (flag) tr.classList.remove("hidden");
            //         else tr.classList.add("hidden");
            //     });
            // }
            // boxArray.forEach(box => box.onclick = filterHandler);
        </script>
    </body>
</html>
